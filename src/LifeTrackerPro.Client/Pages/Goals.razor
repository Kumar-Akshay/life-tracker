@page "/goals"

<PageTitle>Goals â€” LifeTracker Pro</PageTitle>

<div style="display:flex; align-items:center; justify-content:space-between; margin-bottom:20px;">
    <div>
        <h2 class="heading-display" style="font-size:24px; margin:0 0 4px;">Goals & Streaks</h2>
        <p class="subtitle-text" style="margin:0;">Track daily habits and long-term objectives</p>
    </div>
    <button class="lt-btn lt-btn-primary" style="font-size:12px; padding:8px 14px;">
        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
        New Goal
    </button>
</div>

<!-- Streak Cards -->
<div style="display:grid; grid-template-columns:repeat(4, 1fr); gap:12px; margin-bottom:24px;">
    @foreach (var streak in _streaks)
    {
        <div class="metric-card" style="text-align:center;">
            <div style="font-size:28px; margin-bottom:4px;">@streak.Emoji</div>
            <div class="metric-value" style="font-family:'Space Mono',monospace; font-size:24px;">@streak.Count</div>
            <div class="metric-label">@streak.Label</div>
        </div>
    }
</div>

<!-- Daily Goals -->
<div style="margin-bottom:24px;">
    <h3 class="section-header">Daily Goals</h3>
    <div class="glass-card">
        @foreach (var goal in _dailyGoals)
        {
            <div style="padding:12px 0; @(goal != _dailyGoals.Last() ? "border-bottom:1px solid rgba(148,163,184,0.06);" : "")">
                <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:6px;">
                    <div style="display:flex; align-items:center; gap:8px;">
                        <span style="font-size:16px;">@goal.Emoji</span>
                        <span style="color:#e2e8f0; font-size:13px; font-weight:600; font-family:'DM Sans',sans-serif;">@goal.Name</span>
                    </div>
                    <div style="display:flex; align-items:center; gap:8px;">
                        <span style="color:#94a3b8; font-size:11px; font-family:'Space Mono',monospace;">@goal.Current / @goal.Target @goal.Unit</span>
                        @if (goal.Current >= goal.Target)
                        {
                            <span class="lt-tag lt-tag-green" style="font-weight:600;">âœ“ Done</span>
                        }
                    </div>
                </div>
                <div class="lt-progress-bar">
                    <div class="lt-progress-fill" style="width:@GoalPct(goal.Current, goal.Target)%; background:@(goal.Current >= goal.Target ? "#22c55e" : "#6366f1");"></div>
                </div>
            </div>
        }
    </div>
</div>

<!-- Monthly Goals -->
<div style="margin-bottom:24px;">
    <h3 class="section-header">Monthly Goals</h3>
    <div class="glass-card">
        @foreach (var goal in _monthlyGoals)
        {
            <div style="padding:12px 0; @(goal != _monthlyGoals.Last() ? "border-bottom:1px solid rgba(148,163,184,0.06);" : "")">
                <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:6px;">
                    <div style="display:flex; align-items:center; gap:8px;">
                        <span style="font-size:16px;">@goal.Emoji</span>
                        <span style="color:#e2e8f0; font-size:13px; font-weight:600; font-family:'DM Sans',sans-serif;">@goal.Name</span>
                    </div>
                    <span style="color:#94a3b8; font-size:11px; font-family:'Space Mono',monospace;">@goal.Current / @goal.Target @goal.Unit</span>
                </div>
                <div class="lt-progress-bar">
                    <div class="lt-progress-fill" style="width:@GoalPct(goal.Current, goal.Target)%; background:@GoalColor(goal.Current, goal.Target);"></div>
                </div>
            </div>
        }
    </div>
</div>

<!-- Yearly Goals -->
<div>
    <h3 class="section-header">Yearly Goals</h3>
    <div class="glass-card">
        @foreach (var goal in _yearlyGoals)
        {
            <div style="padding:12px 0; @(goal != _yearlyGoals.Last() ? "border-bottom:1px solid rgba(148,163,184,0.06);" : "")">
                <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:6px;">
                    <div style="display:flex; align-items:center; gap:8px;">
                        <span style="font-size:16px;">@goal.Emoji</span>
                        <span style="color:#e2e8f0; font-size:13px; font-weight:600; font-family:'DM Sans',sans-serif;">@goal.Name</span>
                    </div>
                    <span style="color:#94a3b8; font-size:11px; font-family:'Space Mono',monospace;">@goal.Current / @goal.Target @goal.Unit</span>
                </div>
                <div class="lt-progress-bar">
                    <div class="lt-progress-fill" style="width:@GoalPct(goal.Current, goal.Target)%; background:@GoalColor(goal.Current, goal.Target);"></div>
                </div>
            </div>
        }
    </div>
</div>

@code {
    private List<StreakItem> _streaks = new()
    {
        new("ğŸ”¥", 28, "Day Streak"),
        new("ğŸ’ª", 15, "Exercise Streak"),
        new("ğŸ“š", 7, "Reading Streak"),
        new("ğŸ§˜", 12, "Meditation Streak"),
    };

    private List<GoalItem> _dailyGoals = new()
    {
        new("ğŸ‹ï¸", "Exercise", 1, 1, "hr"),
        new("ğŸ“–", "Reading", 30, 30, "min"),
        new("ğŸ’§", "Water Intake", 6, 8, "glasses"),
        new("ğŸ§˜", "Meditation", 10, 15, "min"),
        new("ğŸ“", "Journal Entry", 1, 1, "entry"),
    };

    private List<GoalItem> _monthlyGoals = new()
    {
        new("ğŸ“š", "Books Read", 2, 3, "books"),
        new("ğŸ’°", "Stay Under Budget", 373, 500, "â‚¹"),
        new("ğŸƒ", "Running Distance", 25, 40, "km"),
        new("ğŸ¯", "Productive Hours", 120, 160, "hrs"),
    };

    private List<GoalItem> _yearlyGoals = new()
    {
        new("ğŸ“š", "Read 24 Books", 4, 24, "books"),
        new("âœˆï¸", "Travel to 3 New Places", 1, 3, "places"),
        new("ğŸ’°", "Save â‚¹60,000", 15000, 60000, "â‚¹"),
        new("ğŸ‹ï¸", "365 Exercise Days", 45, 365, "days"),
    };

    private double GoalPct(double current, double target) =>
        target > 0 ? Math.Min((current / target) * 100, 100) : 0;

    private string GoalColor(double current, double target)
    {
        var pct = GoalPct(current, target);
        return pct >= 100 ? "#22c55e" : pct >= 60 ? "#6366f1" : pct >= 30 ? "#eab308" : "#ef4444";
    }

    private record StreakItem(string Emoji, int Count, string Label);
    private record GoalItem(string Emoji, string Name, double Current, double Target, string Unit);
}
