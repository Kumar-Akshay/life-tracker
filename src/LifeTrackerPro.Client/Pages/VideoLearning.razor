@page "/videos"

<PageTitle>Video Learning — LifeTracker Pro</PageTitle>

<div style="display:flex; align-items:center; justify-content:space-between; margin-bottom:20px;">
    <div>
        <h2 class="heading-display" style="font-size:24px; margin:0 0 4px;">Video Learning Hub</h2>
        <p class="subtitle-text" style="margin:0;">Track courses, take notes, master skills</p>
    </div>
    <div style="display:flex; gap:6px;">
        @foreach (var v in new[] { "kanban", "list" })
        {
            var view = v;
            <button @onclick="@(() => _view = view)"
                    style="padding:6px 14px; border-radius:8px; font-size:12px; cursor:pointer; font-family:'DM Sans',sans-serif; text-transform:capitalize; border:1px solid @(_view == view ? "rgba(99,102,241,0.3)" : "rgba(148,163,184,0.1)"); background:@(_view == view ? "rgba(99,102,241,0.15)" : "transparent"); color:@(_view == view ? "#a5b4fc" : "#64748b");">
                @view
            </button>
        }
    </div>
</div>

<!-- Stats -->
<div style="display:grid; grid-template-columns:repeat(4, 1fr); gap:12px; margin-bottom:20px;">
    <div class="metric-card">
        <span class="metric-value">@_videos.SelectMany(x => x.Value).Count()</span>
        <span class="metric-label">Total Videos</span>
    </div>
    <div class="metric-card">
        <span class="metric-value">@_videos.GetValueOrDefault("In Progress", new()).Count</span>
        <span class="metric-label">In Progress</span>
    </div>
    <div class="metric-card">
        <span class="metric-value">23.5h</span>
        <span class="metric-label">Learning Hours</span>
    </div>
    <div class="metric-card">
        <span class="metric-value">3 days</span>
        <span class="metric-label">Learning Streak</span>
    </div>
</div>

@if (_view == "kanban")
{
    <!-- Kanban View -->
    <div style="display:grid; grid-template-columns:repeat(3, 1fr); gap:12px;">
        @foreach (var column in _videos)
        {
            var statusColor = column.Key == "To Start" ? "#64748b" : column.Key == "In Progress" ? "#eab308" : "#22c55e";
            <div class="kanban-col">
                <div style="display:flex; align-items:center; gap:8px; margin-bottom:12px;">
                    <div style="width:8px; height:8px; border-radius:50%; background:@statusColor;"></div>
                    <span style="color:#94a3b8; font-size:12px; font-weight:600; font-family:'DM Sans',sans-serif;">@column.Key</span>
                    <span style="color:#475569; font-size:11px; font-family:'Space Mono',monospace;">@column.Value.Count</span>
                </div>
                @foreach (var item in column.Value)
                {
                    <div class="kanban-card">
                        <div style="font-size:13px; font-weight:600; color:#e2e8f0; margin-bottom:6px; font-family:'DM Sans',sans-serif;">@item.Title</div>
                        <div style="font-size:11px; color:#64748b; margin-bottom:8px; font-family:'DM Sans',sans-serif;">@item.Platform · @item.Duration</div>
                        @if (item.Progress > 0)
                        {
                            <div style="margin-bottom:8px;">
                                <div class="lt-progress-bar" style="height:4px;">
                                    <div class="lt-progress-fill" style="width:@item.Progress%; background:#eab308;"></div>
                                </div>
                                <div style="font-size:10px; color:#64748b; margin-top:3px; font-family:'Space Mono',monospace;">@item.Progress%</div>
                            </div>
                        }
                        <div style="display:flex; flex-wrap:wrap; gap:4px;">
                            @foreach (var tag in item.Tags)
                            {
                                <span class="lt-tag lt-tag-indigo">@tag</span>
                            }
                            <span class="lt-tag @(item.Priority == "High" ? "lt-tag-red" : "lt-tag-yellow")">@item.Priority</span>
                        </div>
                    </div>
                }
            </div>
        }
    </div>
}
else
{
    <!-- List View -->
    <div class="glass-card">
        @foreach (var column in _videos)
        {
            @foreach (var item in column.Value)
            {
                <div style="display:flex; align-items:center; gap:12px; padding:12px 0; border-bottom:1px solid rgba(148,163,184,0.06);">
                    <div style="width:8px; height:8px; border-radius:50%; background:@(column.Key == "To Start" ? "#64748b" : column.Key == "In Progress" ? "#eab308" : "#22c55e"); flex-shrink:0;"></div>
                    <div style="flex:1;">
                        <div style="color:#e2e8f0; font-size:13px; font-weight:600; font-family:'DM Sans',sans-serif;">@item.Title</div>
                        <div style="color:#64748b; font-size:11px; font-family:'DM Sans',sans-serif;">@item.Platform · @item.Duration</div>
                    </div>
                    @if (item.Progress > 0)
                    {
                        <div style="width:80px;">
                            <div class="lt-progress-bar" style="height:4px;">
                                <div class="lt-progress-fill" style="width:@item.Progress%; background:#eab308;"></div>
                            </div>
                        </div>
                    }
                    <div style="display:flex; gap:4px;">
                        @foreach (var tag in item.Tags)
                        {
                            <span class="lt-tag lt-tag-indigo">@tag</span>
                        }
                    </div>
                    <span class="lt-tag @(item.Priority == "High" ? "lt-tag-red" : "lt-tag-yellow")">@item.Priority</span>
                </div>
            }
        }
    </div>
}

@code {
    private string _view = "kanban";

    private Dictionary<string, List<VideoItem>> _videos = new()
    {
        ["To Start"] = new()
        {
            new("System Design Masterclass", "YouTube", "12h", new[] { "Architecture" }, "High", 0),
            new("Docker Fundamentals", "Udemy", "6h", new[] { "DevOps" }, "Med", 0),
        },
        ["In Progress"] = new()
        {
            new("Advanced C# & .NET", "Pluralsight", "8h", new[] { ".NET", "C#" }, "High", 65),
            new("Blazor WASM Deep Dive", "YouTube", "4h", new[] { "Blazor", "WASM" }, "Med", 30),
        },
        ["Completed"] = new()
        {
            new("Git & GitHub Pro", "Udemy", "3h", new[] { "Git" }, "Med", 100),
        },
    };

    private record VideoItem(string Title, string Platform, string Duration, string[] Tags, string Priority, int Progress);
}
