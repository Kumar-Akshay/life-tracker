@page "/spending"

<PageTitle>Spending — LifeTracker Pro</PageTitle>

<div class="page-enter">
    <h1 class="lt-page-heading">Spending & <span class="accent">Budget</span></h1>
    <p class="lt-page-subtitle">Track every dollar, stay in control</p>

    <!-- Budget Overview -->
    <div class="lt-card accent" style="margin-bottom:22px;">
        <div style="display:flex; justify-content:space-between; align-items:baseline; margin-bottom:14px;">
            <span style="font-size:11px; color:var(--ink-muted); font-family:var(--font-mono); text-transform:uppercase; letter-spacing:0.12em;">February Budget</span>
            <span style="font-size:22px; font-weight:700; color:var(--crail); font-family:var(--font-serif);">
                $280 <span style="font-size:14px; font-weight:400; color:var(--ink-muted);">/ $500</span>
            </span>
        </div>
        <div class="lt-progress-budget-track">
            <div class="lt-progress-budget-fill" style="width:56%;"></div>
        </div>
        <div style="display:flex; justify-content:space-between; margin-top:8px;">
            <span style="font-size:10px; color:var(--ink-muted); font-family:var(--font-mono);">56% used</span>
            <span style="font-size:10px; color:var(--success); font-family:var(--font-mono); font-weight:700;">$220 remaining</span>
        </div>
    </div>

    <!-- Stats -->
    <div class="lt-grid-3" style="margin-bottom:22px;">
        <div class="lt-card">
            <div class="lt-stat-label">Avg / Month</div>
            <div class="lt-stat-value">$31</div>
        </div>
        <div class="lt-card">
            <div class="lt-stat-label">Highest</div>
            <div class="lt-stat-value" style="font-size:20px;">FEB $280</div>
        </div>
        <div class="lt-card">
            <div class="lt-stat-label">Year Total</div>
            <div class="lt-stat-value">$373</div>
        </div>
    </div>

    <!-- Monthly Spending Chart (placeholder bars) -->
    <div class="lt-card" style="margin-bottom:22px;">
        <div class="lt-section-label"><span>Monthly Spending</span></div>
        <div style="display:flex; align-items:end; gap:16px; height:160px; padding:16px 0;">
            @foreach (var month in _monthlySpending)
            {
                <div style="flex:1; display:flex; flex-direction:column; align-items:center; justify-content:end; height:100%;">
                    <div style="width:100%; background:var(--crail); border-radius:8px 8px 0 0; min-height:4px; transition:height 1s ease;"
                         class="@($"height:{month.Percent}%")">
                        <div style="width:100%; border-radius:8px 8px 0 0; background:var(--crail); height:@(month.Percent)%;"></div>
                    </div>
                    <span style="font-size:10px; color:var(--ink-muted); font-family:var(--font-mono); margin-top:8px; font-weight:600;">
                        $@month.Amount
                    </span>
                    <span style="font-size:10px; color:var(--ink-soft); font-family:var(--font-sans); margin-top:2px;">@month.Label</span>
                </div>
            }
        </div>
    </div>

    <!-- Transactions -->
    <div class="lt-card">
        <div class="lt-section-label"><span>Transactions</span></div>
        @foreach (var (tx, idx) in _transactions.Select((t, i) => (t, i)))
        {
            <div class="lt-transaction-row" style="@(idx == _transactions.Count - 1 ? "border-bottom:none;" : "")">
                <div>
                    <div style="color:var(--ink); font-size:14px; font-family:var(--font-sans); font-weight:600;">@tx.Description</div>
                    <div style="display:flex; gap:8px; margin-top:4px;">
                        <span style="color:var(--ink-muted); font-size:10px; font-family:var(--font-mono);">@tx.Date</span>
                        <span class="lt-tag crail">@tx.Tag</span>
                    </div>
                </div>
                <span class="lt-transaction-amount">@tx.Amount</span>
            </div>
        }
    </div>
</div>

@code {
    private record MonthData(string Label, int Amount, int Percent);
    private record Transaction(string Date, string Description, string Amount, string Tag);

    private readonly List<MonthData> _monthlySpending = new()
    {
        new("JAN", 93, 33),
        new("FEB", 280, 100),
        new("MAR", 45, 16),
        new("APR", 0, 0)
    };

    private readonly List<Transaction> _transactions = new()
    {
        new("Feb 9", "DJI Camera (Installment)", "$498", "Tech"),
        new("Jan 27", "Send money — Pakistan", "$4,000", "Transfer"),
        new("Jan 26", "Groceries", "$24.50", "Food"),
        new("Jan 27", "Transport", "$17", "Travel")
    };
}
